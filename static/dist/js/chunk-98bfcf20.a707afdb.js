(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-98bfcf20"],{"1c97":function(t,e,n){},2423:function(t,e,n){"use strict";n.d(e,"f",(function(){return r})),n.d(e,"e",(function(){return i})),n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return o})),n.d(e,"d",(function(){return l}));var a=n("b775"),r=function(t){return Object(a["a"])({method:"get",url:"/app/v1_1/articles",params:t})},i=function(t){return Object(a["a"])({method:"get",url:"/app/v1_0/articles/".concat(t)})},s=function(t){return Object(a["a"])({method:"post",url:"/app/v1_0/article/collections",data:{target:t}})},c=function(t){return Object(a["a"])({method:"delete",url:"/app/v1_0/article/collections/".concat(t)})},o=function(t){return Object(a["a"])({method:"post",url:"/app/v1_0/article/likings",data:{target:t}})},l=function(t){return Object(a["a"])({method:"delete",url:"/app/v1_0/article/likings/".concat(t)})}},"3a91":function(t,e,n){"use strict";var a=n("1c97"),r=n.n(a);r.a},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,n){var a=n("1d80"),r=n("5899"),i="["+r+"]",s=RegExp("^"+i+i+"*"),c=RegExp(i+i+"*$"),o=function(t){return function(e){var n=String(a(e));return 1&t&&(n=n.replace(s,"")),2&t&&(n=n.replace(c,"")),n}};t.exports={start:o(1),end:o(2),trim:o(3)}},"6d0f":function(t,e,n){},7394:function(t,e,n){"use strict";var a=n("7c27"),r=n.n(a);r.a},"7abe":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home-container"},[n("van-nav-bar",{staticClass:"page-nav-bar",attrs:{fixed:""}},[n("van-button",{staticClass:"search-btn",attrs:{slot:"title",type:"info",icon:"search",to:"/search"},slot:"title"},[t._v("搜索")])],1),n("van-tabs",{staticClass:"channel-tabs",attrs:{animated:"",swipeable:"","swipe-threshold":"3"},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[t._l(t.channels,(function(t){return n("van-tab",{key:t.id,attrs:{title:t.name}},[n("art-list",{attrs:{channels:t}})],1)})),n("div",{staticClass:"spaceho",attrs:{slot:"nav-right"},slot:"nav-right"}),n("div",{staticClass:"right-btn",attrs:{slot:"nav-right"},on:{click:function(e){t.isShow=!0}},slot:"nav-right"},[n("i",{staticClass:"iconfont icongengduo"})])],2),n("van-popup",{style:{height:"100%"},attrs:{closeable:"","close-icon-position":"top-left",position:"bottom"},model:{value:t.isShow,callback:function(e){t.isShow=e},expression:"isShow"}},[n("channel-edit",{attrs:{"my-channel":t.channels,active:t.active},on:{changeActive:t.updateActive}})],1)],1)},r=[],i=n("5530"),s=(n("96cf"),n("1da1")),c=n("c24f"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"art-container",staticClass:"art-container"},[n("van-pull-refresh",{attrs:{"success-text":t.successText,"success-duration":"1000"},on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[n("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了",error:t.error,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(e){t.error=e},load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(t,e){return n("art-item",{key:e,attrs:{article:t}})})),1)],1)],1)},l=[],u=n("2909"),d=n("2423"),f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("van-cell",{staticClass:"art-item",attrs:{to:"/article/"+t.article.art_id}},[n("div",{staticClass:"title van-multi-ellipsis--l2",attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.article.title))]),n("div",{attrs:{slot:"label"},slot:"label"},[n("div",{staticClass:"text"},[1===t.article.is_top?n("span",{staticStyle:{color:"#E22829"}},[t._v("置顶")]):t._e(),n("span",[t._v(t._s(t.article.aut_name))]),n("span",[t._v(t._s(t.article.comm_count)+"评论")]),n("span",[t._v(t._s(t._f("relativeTime")(t.article.pubdate)))])])]),1===t.article.cover.type?n("van-image",{attrs:{slot:"default",fit:"cover",src:t.article.cover.images[0]},slot:"default"}):3===t.article.cover.type?n("div",{staticClass:"img-three",attrs:{slot:"label"},slot:"label"},[n("van-image",{attrs:{src:t.article.cover.images[0],fit:"cover"}}),n("van-image",{attrs:{src:t.article.cover.images[1],fit:"cover"}}),n("van-image",{attrs:{src:t.article.cover.images[2],fit:"cover"}})],1):t._e()],1)],1)},h=[],v={props:{article:Object},data:function(){return{}}},p=v,m=(n("3a91"),n("2877")),b=Object(m["a"])(p,f,h,!1,null,"5e90b5d8",null),g=b.exports,x=n("2ef0"),_={name:"artList",props:{channels:Object},data:function(){return{list:[],loading:!1,finished:!1,refreshing:!1,timestamp:null,error:!1,successText:"刷新成功",scrollTop:0}},methods:{onLoad:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,a,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,a={channel_id:t.channels.id,timestamp:t.timestamp||Date.now(),with_top:1},e.next=4,Object(d["f"])(a);case 4:r=e.sent,i=r.data,(n=t.list).push.apply(n,Object(u["a"])(i.data.results)),t.loading=!1,t.list.length?t.timestamp=i.data.pre_timestamp:t.finished=!0,e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](0),t.error=!0,t.loading=!1;case 15:case"end":return e.stop()}}),e,null,[[0,11]])})))()},onRefresh:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,a,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,a={channel_id:t.channels.id,timestamp:Date.now(),with_top:1},e.next=4,Object(d["f"])(a);case 4:r=e.sent,i=r.data,(n=t.list).unshift.apply(n,Object(u["a"])(i.data.results)),t.refreshing=!1,t.successText="刷新成功，更新了".concat(i.data.results.length,"条数据"),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](0),t.refreshing=!1,t.successText="刷新失败";case 15:case"end":return e.stop()}}),e,null,[[0,11]])})))()}},components:{artItem:g},mounted:function(){var t=this,e=this.$refs["art-container"];e.onscroll=Object(x["debounce"])((function(){t.scrollTop=e.scrollTop}),50)},activated:function(){this.$refs["art-container"].scrollTop=this.scrollTop}},C=_,O=(n("e0df"),Object(m["a"])(C,o,l,!1,null,"a6f5831a",null)),w=O.exports,j=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"channelEdit"},[n("van-cell",{attrs:{border:!1}},[n("div",{staticClass:"title-text",attrs:{slot:"title"},slot:"title"},[t._v("我的频道")]),n("van-button",{staticClass:"edit-btn",attrs:{round:"",plain:"",size:"mini",type:"danger"},on:{click:t.edit}},[t._v(t._s(t.editText))])],1),n("van-grid",{attrs:{gutter:10}},t._l(t.myChannel,(function(e,a){return n("van-grid-item",{key:e.id,on:{click:function(n){return t.changeChannel(e)}}},[n("van-icon",{directives:[{name:"show",rawName:"v-show",value:t.isEdit&&!t.fiexChanel.includes(e.id),expression:"isEdit&&!fiexChanel.includes(value.id)"}],attrs:{slot:"icon",name:"clear"},slot:"icon"}),n("span",{staticClass:"text",class:a===t.active?"redactive":"",attrs:{slot:"text"},slot:"text"},[t._v(t._s(e.name))])],1)})),1),n("van-cell",{attrs:{border:!1}},[n("div",{staticClass:"title-text",attrs:{slot:"title"},slot:"title"},[t._v("频道推荐")])]),n("van-grid",{staticClass:"rem-grid",attrs:{gutter:10}},t._l(t.reChannels,(function(e){return n("van-grid-item",{key:e.id,attrs:{icon:"plus",text:e.name},on:{click:function(n){return t.addChannels(e)}}})})),1)],1)},k=[],y=(n("4de4"),n("7db0"),n("c740"),n("caad"),n("a434"),n("a9e3"),n("2532"),n("b775")),E=function(){return Object(y["a"])({method:"get",url:"/app/v1_0/channels"})},I=function(t){return Object(y["a"])({method:"patch",url:"/app/v1_0/user/channels",data:{channels:[t]}})},A=function(t){return Object(y["a"])({method:"delete",url:"/app/v1_0/user/channels/".concat(t)})},N=n("2f62"),T=n("5d2d"),R={props:{myChannel:Array,active:Number},data:function(){return{allChannelsList:[],isEdit:!1,editText:"编辑",fiexChanel:[0]}},computed:Object(i["a"])({reChannels:function(){var t=this;return this.allChannelsList.filter((function(e){return!t.myChannel.find((function(t){return t.id===e.id}))}))}},Object(N["b"])(["user"])),methods:{loadUserChannels:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E();case 3:n=e.sent,a=n.data,t.allChannelsList=a.data.channels,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),t.$toast("数据获取失败");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},addChannels:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.myChannel.push(t),!e.user){n.next=13;break}return n.prev=2,a={id:t.id,seq:e.myChannel.length},n.next=6,I(a);case 6:n.next=11;break;case 8:n.prev=8,n.t0=n["catch"](2),e.$toast("添加频道失败，请稍后重试");case 11:n.next=14;break;case 13:Object(T["b"])("userChannels",e.myChannel);case 14:case"end":return n.stop()}}),n,null,[[2,8]])})))()},edit:function(){this.isEdit=!this.isEdit,this.isEdit?this.editText="完成":this.editText="编辑"},changeChannel:function(t){if(this.isEdit){if(this.fiexChanel.includes(t.id))return;var e=this.myChannel.findIndex((function(e){return e.id===t.id}));e<=this.active&&this.$emit("changeActive",this.active-1),this.myChannel.splice(e,1),this.delChannel(t.id)}else{var n=this.myChannel.findIndex((function(e){return e.id===t.id}));this.$emit("changeActive",n,!1)}},delChannel:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!e.user){n.next=11;break}return n.prev=1,n.next=4,A(t);case 4:n.next=9;break;case 6:n.prev=6,n.t0=n["catch"](1),e.$toast("删除频道失败，请稍后重试");case 9:n.next=12;break;case 11:Object(T["b"])("userChannels",e.myChannel);case 12:case"end":return n.stop()}}),n,null,[[1,6]])})))()}},created:function(){this.loadUserChannels()}},S=R,$=(n("c0e6"),Object(m["a"])(S,j,k,!1,null,"2762c566",null)),L=$.exports,F={data:function(){return{active:0,channels:[],isShow:!1}},components:{artList:w,channelEdit:L},methods:{loadChannels:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,a,r,i,s,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=[],!t.user){e.next=9;break}return e.next=4,Object(c["a"])();case 4:a=e.sent,r=a.data,n=r.data.channels,e.next=19;break;case 9:if(i=Object(T["a"])("userChannels"),!i){e.next=14;break}n=i,e.next=19;break;case 14:return e.next=16,Object(c["a"])();case 16:s=e.sent,o=s.data,n=o.data.channels;case 19:t.channels=n;case 20:case"end":return e.stop()}}),e)})))()},updateActive:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.active=t,this.isShow=e}},created:function(){this.loadChannels()},computed:Object(i["a"])({},Object(N["b"])(["user"]))},M=F,U=(n("7394"),Object(m["a"])(M,a,r,!1,null,"5b43d65b",null));e["default"]=U.exports},"7c27":function(t,e,n){},"7db0":function(t,e,n){"use strict";var a=n("23e7"),r=n("b727").find,i=n("44d2"),s=n("ae40"),c="find",o=!0,l=s(c);c in[]&&Array(1)[c]((function(){o=!1})),a({target:"Array",proto:!0,forced:o||!l},{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),i(c)},"9fe1":function(t,e,n){},a9e3:function(t,e,n){"use strict";var a=n("83ab"),r=n("da84"),i=n("94ca"),s=n("6eeb"),c=n("5135"),o=n("c6b6"),l=n("7156"),u=n("c04e"),d=n("d039"),f=n("7c73"),h=n("241c").f,v=n("06cf").f,p=n("9bf2").f,m=n("58a8").trim,b="Number",g=r[b],x=g.prototype,_=o(f(x))==b,C=function(t){var e,n,a,r,i,s,c,o,l=u(t,!1);if("string"==typeof l&&l.length>2)if(l=m(l),e=l.charCodeAt(0),43===e||45===e){if(n=l.charCodeAt(2),88===n||120===n)return NaN}else if(48===e){switch(l.charCodeAt(1)){case 66:case 98:a=2,r=49;break;case 79:case 111:a=8,r=55;break;default:return+l}for(i=l.slice(2),s=i.length,c=0;c<s;c++)if(o=i.charCodeAt(c),o<48||o>r)return NaN;return parseInt(i,a)}return+l};if(i(b,!g(" 0o1")||!g("0b1")||g("+0x1"))){for(var O,w=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof w&&(_?d((function(){x.valueOf.call(n)})):o(n)!=b)?l(new g(C(e)),n,w):C(e)},j=a?h(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),k=0;j.length>k;k++)c(g,O=j[k])&&!c(w,O)&&p(w,O,v(g,O));w.prototype=x,x.constructor=w,s(r,b,w)}},c0e6:function(t,e,n){"use strict";var a=n("9fe1"),r=n.n(a);r.a},c24f:function(t,e,n){"use strict";n.d(e,"d",(function(){return r})),n.d(e,"e",(function(){return i})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return o}));var a=n("b775"),r=function(t){return Object(a["a"])({method:"post",url:"/app/v1_0/authorizations",data:t})},i=function(t){return Object(a["a"])({method:"get",url:"/app/v1_0/sms/codes/"+t})},s=function(){return Object(a["a"])({method:"get",url:"/app/v1_0/user"})},c=function(){return Object(a["a"])({method:"get",url:"/app/v1_0/user/channels"})},o=function(t){return Object(a["a"])({method:"get",url:"/app/v1_0/article/collections",params:t})}},c740:function(t,e,n){"use strict";var a=n("23e7"),r=n("b727").findIndex,i=n("44d2"),s=n("ae40"),c="findIndex",o=!0,l=s(c);c in[]&&Array(1)[c]((function(){o=!1})),a({target:"Array",proto:!0,forced:o||!l},{findIndex:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),i(c)},e0df:function(t,e,n){"use strict";var a=n("6d0f"),r=n.n(a);r.a}}]);
//# sourceMappingURL=chunk-98bfcf20.a707afdb.js.map