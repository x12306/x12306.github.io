(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0c2631c4"],{4939:function(e,t,n){},"4d63":function(e,t,n){var r=n("83ab"),a=n("da84"),s=n("94ca"),c=n("7156"),i=n("9bf2").f,o=n("241c").f,l=n("44e7"),u=n("ad6d"),h=n("9f7f"),f=n("6eeb"),d=n("d039"),p=n("69f3").set,v=n("2626"),g=n("b622"),b=g("match"),m=a.RegExp,x=m.prototype,y=/a/g,w=/a/g,k=new m(y)!==y,H=h.UNSUPPORTED_Y,_=r&&s("RegExp",!k||H||d((function(){return w[b]=!1,m(y)!=y||m(w)==w||"/a/i"!=m(y,"i")})));if(_){var O=function(e,t){var n,r=this instanceof O,a=l(e),s=void 0===t;if(!r&&a&&e.constructor===O&&s)return e;k?a&&!s&&(e=e.source):e instanceof O&&(s&&(t=u.call(e)),e=e.source),H&&(n=!!t&&t.indexOf("y")>-1,n&&(t=t.replace(/y/g,"")));var i=c(k?new m(e,t):m(e,t),r?this:x,O);return H&&n&&p(i,{sticky:n}),i},R=function(e){e in O||i(O,e,{configurable:!0,get:function(){return m[e]},set:function(t){m[e]=t}})},j=o(m),S=0;while(j.length>S)R(j[S++]);x.constructor=O,O.prototype=x,f(a,"RegExp",O)}v("RegExp")},"4e3b":function(e,t,n){},bf6f:function(e,t,n){"use strict";var r=n("c7d5"),a=n.n(r);a.a},c7d5:function(e,t,n){},e110:function(e,t,n){"use strict";var r=n("4e3b"),a=n.n(r);a.a},e1a8:function(e,t,n){"use strict";var r=n("4939"),a=n.n(r);a.a},efe3:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"search-container"},[n("form",{staticClass:"search-form",attrs:{action:"/"}},[n("van-search",{attrs:{"show-action":"",background:"#3296fa",placeholder:"请输入搜索关键词"},on:{search:e.onSearch,cancel:e.onCancel,focus:function(t){e.isResult=!1}},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),e.isResult?n("search-result",{attrs:{searchText:e.value}}):0===e.value.length?n("search-history",{attrs:{searchHistory:e.searchHistory},on:{allDel:function(t){e.searchHistory=[]},search:e.onSearch}}):n("search-suggest",{attrs:{searchText:e.value},on:{search:e.onSearch}})],1)},a=[],s=(n("c975"),n("a434"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"searchHistory-container"},[n("van-cell",{attrs:{title:"历史记录"}},[e.isDel?n("div",{staticClass:"btn"},[n("span",{on:{click:e.delAll}},[e._v("全部删除")]),n("span",{on:{click:function(t){e.isDel=!1}}},[e._v("完成")])]):n("van-icon",{attrs:{name:"delete"},on:{click:function(t){e.isDel=!0}}})],1),e._l(e.searchHistory,(function(t,r){return n("van-cell",{key:r,attrs:{title:t},on:{click:function(n){return e.searchHisClick(t)}}},[n("van-icon",{directives:[{name:"show",rawName:"v-show",value:e.isDel,expression:"isDel"}],attrs:{name:"cross"}})],1)}))],2)}),c=[],i={props:{searchHistory:Array},data:function(){return{isDel:!1}},methods:{searchHisClick:function(e){if(this.isDel){var t=this.searchHistory.indexOf(e);this.searchHistory.splice(t,1)}else this.$emit("search",e)},delAll:function(){this.$emit("allDel")}}},o=i,l=(n("e110"),n("2877")),u=Object(l["a"])(o,s,c,!1,null,"758a3ad1",null),h=u.exports,f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"search-box"},e._l(e.suggestions,(function(t,r){return n("van-cell",{key:r,attrs:{icon:"search"},on:{click:function(n){return e.$emit("search",t)}}},[n("div",{attrs:{slot:"title"},domProps:{innerHTML:e._s(e.hightlight(t))},slot:"title"})])})),1)},d=[],p=(n("4d63"),n("ac1f"),n("25f0"),n("5319"),n("96cf"),n("1da1")),v=n("b775"),g=function(e){return Object(v["a"])({method:"get",url:"/app/v1_0/suggestion",params:{q:e}})},b=function(e){return Object(v["a"])({method:"get",url:"/app/v1_0/search",params:e})},m=n("2ef0"),x={props:{searchText:String},data:function(){return{suggestions:[]}},watch:{searchText:{handler:Object(m["debounce"])((function(e){this.loadSearchSuggestion(e)}),300),immediate:!0}},methods:{loadSearchSuggestion:function(e){var t=this;return Object(p["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,g(e);case 3:r=n.sent,a=r.data,t.suggestions=a.data.options,n.next=11;break;case 8:n.prev=8,n.t0=n["catch"](0),t.$toast("获取数据失败，请稍后重试");case 11:case"end":return n.stop()}}),n,null,[[0,8]])})))()},hightlight:function(e){var t="<span class='colorText'>".concat(this.searchText,"</span>"),n=new RegExp(this.searchText,"gi");return e.replace(n,t)}}},y=x,w=(n("e1a8"),Object(l["a"])(y,f,d,!1,null,"c6abe6f2",null)),k=w.exports,H=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("van-list",{attrs:{finished:e.finished,"finished-text":"没有更多了",error:e.error,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(t){e.error=t},load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.list,(function(e,t){return n("van-cell",{key:t,attrs:{title:e.title}})})),1)],1)},_=[],O=n("2909"),R={props:{searchText:String},data:function(){return{list:[],loading:!1,finished:!1,page:1,error:!1}},methods:{onLoad:function(){var e=this;return Object(p["a"])(regeneratorRuntime.mark((function t(){var n,r,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r={page:e.page,per_page:10,q:e.searchText},t.next=4,b(r);case 4:a=t.sent,s=a.data,(n=e.list).push.apply(n,Object(O["a"])(s.data.results)),e.loading=!1,s.data.results.length?e.page++:e.finished=!0,t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](0),e.error=!0,e.loading=!1;case 15:case"end":return t.stop()}}),t,null,[[0,11]])})))()}}},j=R,S=Object(l["a"])(j,H,_,!1,null,"76a3b889",null),T=S.exports,D=n("5d2d"),E={data:function(){return{value:"",isResult:!1,searchHistory:Object(D["a"])("searchHistories")||[]}},components:{searchHistory:h,searchSuggest:k,searchResult:T},methods:{onSearch:function(e){this.value=e;var t=this.searchHistory.indexOf(e);-1!==t&&this.searchHistory.splice(t,1),this.searchHistory.unshift(e),this.isResult=!0},onCancel:function(){this.$router.push("/")}},watch:{searchHistory:function(e){Object(D["b"])("searchHistories",e)}}},C=E,$=(n("bf6f"),Object(l["a"])(C,r,a,!1,null,"67c987a2",null));t["default"]=$.exports}}]);
//# sourceMappingURL=chunk-0c2631c4.f67c1ce7.js.map